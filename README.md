Please check the comments in the code
